<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2. Get Data • SEQKoalaDataPipeline</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2. Get Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SEQKoalaDataPipeline</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/index.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/v01-setup.html">1. Setup</a></li>
    <li><a class="dropdown-item" href="../articles/v02-get-data.html">2. Get Data</a></li>
    <li><a class="dropdown-item" href="../articles/v03-linear-referencing.html">3. Linear Referencing</a></li>
    <li><a class="dropdown-item" href="../articles/v04-covariates.html">4. Covariate extraction</a></li>
    <li><a class="dropdown-item" href="../articles/v05-master-data.html">5. Master data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>2. Get Data</h1>
            
      

      <div class="d-none name"><code>v02-get-data.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://seq-koala-monitoring.github.io/data-pipeline/">SEQKoalaDataPipeline</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dieghernan.github.io/tidyterra/" class="external-link">tidyterra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="st">"M:\\Users\\uqfcho\\Documents\\seq-koala-monitoring\\working_data"</span></span>
<span><span class="co">#data_dir &lt;- "C:\\Users\\uqfcho\\Documents/seq-koala-monitoring/working_data"</span></span>
<span><span class="fu"><a href="../reference/fcn_set_home_dir.html">fcn_set_home_dir</a></span><span class="op">(</span><span class="va">data_dir</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/fcn_set_grid_size.html">fcn_set_grid_size</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> <span class="co"># grid width/ height in meters, and generate grid in local environment</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 2467, 1759, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 100, 100  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 378280, 554180, 6862464, 7109164  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : GDA2020 / MGA zone 56 (EPSG:7856) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; name        :  GridID </span></span>
<span><span class="co">#&gt; min value   :       1 </span></span>
<span><span class="co">#&gt; max value   : 2311397</span></span>
<span><span class="va">fishnet</span> <span class="op">&lt;-</span> <span class="fu">fcn_get_grid</span><span class="op">(</span><span class="op">)</span> <span class="co"># Retrieve grid from environment for plotting</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extract-data-from-the-database">Extract data from the database<a class="anchor" aria-label="anchor" href="#extract-data-from-the-database"></a>
</h2>
<p>The line transect feature class table can be extracted from the
ACCESS database directly through one function. Behind this function
call, R does the following steps:</p>
<ol style="list-style-type: decimal">
<li>Establishes the ODBC connection with the ACCESS database</li>
<li>Executes SQL queries to pull data from that database</li>
<li>Reads the columns with start and end northings and eastings</li>
<li>Generates a spatial representation for each transect based on those
columns</li>
</ol>
<p>A one-liner solution to extract all line transect information from
both 1996 and 2020 databases are as follows, producing the so-called
“Master” database for the line transects.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">line_transects</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fcn_line_transect_sf_all.html">fcn_line_transect_sf_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in fcn_keep_distinct(transect_sf): 24 records cannot be uniquely</span></span>
<span><span class="co">#&gt; identified with SiteNumber-TransectNumber-SurveyNumber. Keeping only</span></span>
<span><span class="co">#&gt; distinct records.</span></span>
<span><span class="co">#&gt; Warning in fcn_line_transect_sf_1996(): Line Transect: attribute join incomplete. </span></span>
<span><span class="co">#&gt; Joined uniquely: 376. </span></span>
<span><span class="co">#&gt; Joined at the site level: 169. </span></span>
<span><span class="co">#&gt; Join failed: 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">line_transects</span><span class="op">)</span></span>
<span><span class="co">#&gt;       db             TransectID            SiteID      </span></span>
<span><span class="co">#&gt;  Length:2963        Length:2963        Min.   :   1.0  </span></span>
<span><span class="co">#&gt;  Class :character   Class :character   1st Qu.: 122.0  </span></span>
<span><span class="co">#&gt;  Mode  :character   Mode  :character   Median : 416.0  </span></span>
<span><span class="co">#&gt;                                        Mean   : 509.8  </span></span>
<span><span class="co">#&gt;                                        3rd Qu.: 814.5  </span></span>
<span><span class="co">#&gt;                                        Max.   :1301.0  </span></span>
<span><span class="co">#&gt;                                                        </span></span>
<span><span class="co">#&gt;       Date                           TrSiteID         Tlength       </span></span>
<span><span class="co">#&gt;  Min.   :2001-08-28 00:00:00.00   Min.   :   1.0   Min.   :  19.42  </span></span>
<span><span class="co">#&gt;  1st Qu.:2020-06-19 00:00:00.00   1st Qu.: 111.0   1st Qu.: 226.04  </span></span>
<span><span class="co">#&gt;  Median :2021-07-21 00:00:00.00   Median : 417.0   Median : 447.00  </span></span>
<span><span class="co">#&gt;  Mean   :2019-06-22 07:14:28.71   Mean   : 483.3   Mean   : 524.78  </span></span>
<span><span class="co">#&gt;  3rd Qu.:2022-03-23 00:00:00.00   3rd Qu.: 814.5   3rd Qu.: 733.81  </span></span>
<span><span class="co">#&gt;  Max.   :2022-12-20 00:00:00.00   Max.   :1301.0   Max.   :2281.24  </span></span>
<span><span class="co">#&gt;                                                                     </span></span>
<span><span class="co">#&gt;  Number_Sightings Number_Observers Start_Eastings   Start_Northings  </span></span>
<span><span class="co">#&gt;  Min.   :0.0000   Min.   : 1.000   Min.   :399462   Min.   :6870195  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.0000   1st Qu.: 2.000   1st Qu.:466312   1st Qu.:6939228  </span></span>
<span><span class="co">#&gt;  Median :0.0000   Median : 2.000   Median :491411   Median :6972056  </span></span>
<span><span class="co">#&gt;  Mean   :0.1974   Mean   : 2.086   Mean   :484205   Mean   :6975275  </span></span>
<span><span class="co">#&gt;  3rd Qu.:0.0000   3rd Qu.: 2.000   3rd Qu.:501812   3rd Qu.:6998774  </span></span>
<span><span class="co">#&gt;  Max.   :8.0000   Max.   :70.000   Max.   :550605   Max.   :7106583  </span></span>
<span><span class="co">#&gt;                   NA's   :1        NA's   :169      NA's   :169      </span></span>
<span><span class="co">#&gt;   End_Eastings    End_Northings              geometry   </span></span>
<span><span class="co">#&gt;  Min.   :399394   Min.   :6870028   LINESTRING   :2794  </span></span>
<span><span class="co">#&gt;  1st Qu.:466208   1st Qu.:6939270   MULTIPOLYGON : 169  </span></span>
<span><span class="co">#&gt;  Median :491319   Median :6971992   epsg:7856    :   0  </span></span>
<span><span class="co">#&gt;  Mean   :484208   Mean   :6975276   +proj=utm ...:   0  </span></span>
<span><span class="co">#&gt;  3rd Qu.:501743   3rd Qu.:6998793                       </span></span>
<span><span class="co">#&gt;  Max.   :551033   Max.   :7106708                       </span></span>
<span><span class="co">#&gt;  NA's   :169      NA's   :169</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">line_transects</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Number_Sightings</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="fig-unnamed-chunk-4-1.png" alt="plot of chunk unnamed-chunk-4"><div class="figcaption">plot of chunk unnamed-chunk-4</div>
</div>
<p>For this current iteration of the database, the line transects in the
1996 database cannot be joined completely with the transect-level
spatial representation. When a unique transect-level spatial
representation is found, the line transect record is joined to the
transect-level spatial feature, but if that is not possible then it
falls back to using the site-level spatial representation. Only if the
site-level representation is not found does the algorithm fall back to
removing that record. Here in this demonstration we see that the
algorithm finds 386 line transect records that can be joined with the
transect-level spatial feature, and 169 that can be joined at the site
level. 0 records were discarded.</p>
<div class="section level4">
<h4 id="data">1996-2015 data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>The user can also opt to extract just the line transect data from the
1996 database. The same warning message shows up notifying the end user
that indeed some of the line transects had to be joined at the
site-level.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table_sf_1996</span> <span class="op">&lt;-</span> <span class="fu">fcn_line_transect_sf_1996</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in fcn_keep_distinct(transect_sf): 24 records cannot be uniquely</span></span>
<span><span class="co">#&gt; identified with SiteNumber-TransectNumber-SurveyNumber. Keeping only</span></span>
<span><span class="co">#&gt; distinct records.</span></span>
<span><span class="co">#&gt; Warning in fcn_line_transect_sf_1996(): Line Transect: attribute join incomplete. </span></span>
<span><span class="co">#&gt; Joined uniquely: 376. </span></span>
<span><span class="co">#&gt; Joined at the site level: 169. </span></span>
<span><span class="co">#&gt; Join failed: 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">table_sf_1996</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 545</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="onwards-data">2020 onwards data<a class="anchor" aria-label="anchor" href="#onwards-data"></a>
</h4>
<p>Equivalently we can extract the data for the 2020 database. No errors
are thrown here because each line transect is identified uniquely using
coordinate information.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table_sf_2020</span> <span class="op">&lt;-</span> <span class="fu">fcn_line_transect_sf_2020</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">table_sf_2020</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2418</span></span></code></pre></div>
<p>Define the bounding box for plotting</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">441430</span>, <span class="fl">449400</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6928706</span>, <span class="fl">6936814</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">bbox_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bbox</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">$</span><span class="va">ylim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">$</span><span class="va">ylim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">$</span><span class="va">ylim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">$</span><span class="va">ylim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">bbox</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">$</span><span class="va">ylim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bbox_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="va">bbox_sf</span><span class="op">)</span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">bbox_sf</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fcn_get_state.html">fcn_get_state</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">crs</span></span></code></pre></div>
<p>We can draw a simple plot to show the line transects for any
particular region with ggplot. Here we plot the line transects and the
grid cells.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fishnet_bbox</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">fishnet</span>, <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">bbox_sf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fishnet_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fishnet_bbox</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>grid_id_plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">GridID</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">GridID</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">GridID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">grid_id_plot</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">coord_sf</span>, <span class="va">bbox</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set3"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">transect_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">line_transects</span>, color <span class="op">=</span> <span class="st">'#D55E00'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">coord_sf</span>, <span class="va">bbox</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fishnet_plot</span> <span class="op">+</span> <span class="va">transect_plot</span></span></code></pre></div>
<div class="float">
<img src="fig-line_transect_plot-1.png" alt="plot of chunk line_transect_plot"><div class="figcaption">plot of chunk line_transect_plot</div>
</div>
</div>
<div class="section level3">
<h3 id="perpendicular-distances">Perpendicular distances<a class="anchor" aria-label="anchor" href="#perpendicular-distances"></a>
</h3>
<p>Perpendicular distances can be extracted with the following function
calls. It produces the following columns:</p>
<ol style="list-style-type: decimal">
<li><p>TransectID: matches many-to-one to TransectID in line transect
tables</p></li>
<li><p>SightingID: uniquely identifies each koala sighting, with id
assigned as “TransectID”.”SightingNumber”</p></li>
<li><p>Perp_Dist: perpendicular distance of the koala sighting</p></li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perp_distance_1996</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fcn_perp_distance_table_1996.html">fcn_perp_distance_table_1996</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">perp_distance_2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fcn_perp_distance_table_2020.html">fcn_perp_distance_table_2020</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">perp_distance_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fcn_perp_distance_all.html">fcn_perp_distance_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in fcn_perp_distance_table_2015(): could not find function "fcn_perp_distance_table_2015"</span></span></code></pre></div>
<p>This following line checks if the number of koala sightings in the
line transect table matches the number of koala sightings reported in
the perpendicular distances table. Both numbers should be identical as a
sign of successful data extraction.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">perp_distance_all</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): object 'perp_distance_all' not found</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">line_transects</span><span class="op">$</span><span class="va">Number_Sightings</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 585</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="strip-transects">Strip transects<a class="anchor" aria-label="anchor" href="#strip-transects"></a>
</h2>
<p>Strip transects are extracted using a similar interface. Likewise to
line transects, the strip transects are joined with its spatial
representation in the geodatabase, with a fallback to joining at the
site level if an exact match at the transect level is not found.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strip_transects</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fcn_strip_transect_sf_all.html">fcn_strip_transect_sf_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in fcn_keep_distinct(transect_sf, cols = c("SiteNumber",</span></span>
<span><span class="co">#&gt; "TransectNumber", : 66 records cannot be uniquely identified with</span></span>
<span><span class="co">#&gt; SiteNumber-TransectNumber-SurveyNumber. Keeping only distinct records.</span></span>
<span><span class="co">#&gt; Warning in fcn_strip_transect_sf_all(): Strip Transect: attribute join incomplete. </span></span>
<span><span class="co">#&gt; Joined uniquely: 916. </span></span>
<span><span class="co">#&gt; Joined at the site level: 1726. </span></span>
<span><span class="co">#&gt; Join failed: 0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="all-of-area-searches">All of area searches<a class="anchor" aria-label="anchor" href="#all-of-area-searches"></a>
</h2>
<p>Similarly, data for all of area searches can be extracted using the
following function:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uaoa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fcn_all_of_area_sf_all.html">fcn_all_of_area_sf_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">uaoa</span><span class="op">$</span><span class="va">Number_Sightings</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 650</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary-tables">Summary tables<a class="anchor" aria-label="anchor" href="#summary-tables"></a>
</h2>
<p>The script <code>fcn_all_tables</code> extracts all tables into a
list structure.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">master</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fcn_all_tables.html">fcn_all_tables</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in fcn_perp_distance_table_2015(): could not find function "fcn_perp_distance_table_2015"</span></span></code></pre></div>
<p>Summary statistics can be produced of the full table. For example, to
count the number of koalas sighted in each LGA.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_table</span> <span class="op">&lt;-</span> <span class="fu">fcn_summarise_sightings</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'LGA'</span>, <span class="st">'Method'</span>, <span class="st">'db'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">summary_table</span></span>
<span><span class="co">#&gt; # A tibble: 27 x 4</span></span>
<span><span class="co">#&gt; # Groups:   LGA, Method [26]</span></span>
<span><span class="co">#&gt;    LGA            Method         db        Sightings</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;         &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 Brisbane       line_transect  2020-cur         33</span></span>
<span><span class="co">#&gt;  2 Brisbane       strip_transect 1996-2015       743</span></span>
<span><span class="co">#&gt;  3 Brisbane       uaoa           1996-2015         0</span></span>
<span><span class="co">#&gt;  4 Gold Coast     line_transect  2020-cur         41</span></span>
<span><span class="co">#&gt;  5 Gold Coast     strip_transect 1996-2015        29</span></span>
<span><span class="co">#&gt;  6 Gold Coast     uaoa           1996-2015        24</span></span>
<span><span class="co">#&gt;  7 Ipswich        line_transect  2020-cur         47</span></span>
<span><span class="co">#&gt;  8 Ipswich        strip_transect 1996-2015        37</span></span>
<span><span class="co">#&gt;  9 Ipswich        uaoa           1996-2015         3</span></span>
<span><span class="co">#&gt; 10 Lockyer Valley line_transect  2020-cur          6</span></span>
<span><span class="co">#&gt; # i 17 more rows</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Frankie Cho, Jonathan Rhodes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
