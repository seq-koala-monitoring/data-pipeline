SELECT tblTransects.[Site Number] & '_' & tblSightings.[Sub-Survey Number] & '_' & tblSightings.[Transect Number] & '_' & Switch(tblTransects.SurveyMethod='Strip', 'ST', tblTransects.SurveyMethod='Line', 'SOL', tblTransects.SurveyMethod='Urban', 'UAoA') & '_' & Format(tblTransects.Date, 'yyyymmdd') AS TransectID, tblSightings.[Site Number] AS SiteNumber, tblSightings.[Transect Number] AS TransectNumber,tblSightings.[Survey Number] AS SurveyNumber, tblTransects.Date, tblTransects.Length AS Tlength, tblSightings.[Sighting Number] AS Sighting_Number, tblTransects.[Number of Searchers] AS Number_Observers, tblSightings.Easting AS Start_Eastings, tblSightings.Northing AS Start_Northings, tblSightings.Easting_AGD AS End_Eastings, tblSightings.Northing_AGD AS End_Northings
FROM tblSightings LEFT JOIN tblTransects ON (tblSightings.[Transect Number] = tblTransects.[Transect Number]) AND (tblSightings.[Site Number] = tblTransects.[Site Number]) AND (tblSightings.[Sub-Survey Number] = tblTransects.[Sub-Survey Number]) AND (tblSightings.[Survey Number] = tblTransects.[Survey Number])
WHERE tblTransects.SurveyMethod = 'Line' AND tblSightings.[Sighting Number] <= 1;
